<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digit Code</title>
    <style>
        .top div {  
          font-size: 50px;
          display: flex;
          align-items: center;
          justify-content: center;
          color: #004d45;
        } 

        .top div a {  
          color: #004d45;
          font-size: 25px;
          text-decoration: unset;
        } 

        .top {
          background-color: #fcf6d6;
          width: 100%;
          /* Add these to position .top at the top */
          position: sticky; /* Or position: fixed; */
          top: 0;
          z-index: 1; /* Ensure .top is above other content */
          margin-bottom: 20px;
        }

        body {
            background: #077b4c;
            display: flex;
            flex-direction: column;
/*            justify-content: center; /* This might not be needed anymore */
            align-items: center; /* This might not be needed anymore */*/
            height: 100vh;
            margin: 0; /* Remove the default body margin */
        }

        .board {
            display: grid;
            grid-template-columns: repeat(3, auto);
            gap: 40px;
            justify-content: center;
            background: #f3f3f3;
            padding: 40px 80px 40px 80px;

            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        .digit {
            display: flex;
            position: relative;
            width: 28px;
            height: 50px;
            margin: 0 4px;
        }
        .digit span {
            opacity: 0;
            position: absolute;
            background-color: #272e38;
            transition: 0.25s;
        }
        .digit span:before,
        .digit span:after {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
            border: 5px solid transparent;
        }

        .digit .d1 {
            height: 5px;
            width: 16px;
            top: 0;
            left: 6px;
        }
        .digit .d1:before {
            border-width: 0 5px 5px 0;
            border-right-color: inherit;
            left: -5px;
        }
        .digit .d1:after {
            border-width: 0 0 5px 5px;
            border-left-color: inherit;
            right: -5px;
        }

        .digit .d2 {
            height: 5px;
            width: 16px;
            top: 24px;
            left: 6px;
        }
        .digit .d2:before {
            border-width: 3px 4px 2px;
            border-right-color: inherit;
            left: -8px;
        }
        .digit .d2:after {
            border-width: 3px 4px 2px;
            border-left-color: inherit;
            right: -8px;
        }

        .digit .d3 {
            height: 5px;
            width: 16px;
            top: 48px;
            left: 6px;
        }
        .digit .d3:before {
            border-width: 5px 5px 0 0;
            border-right-color: inherit;
            left: -5px;
        }
        .digit .d3:after {
            border-width: 5px 0 0 5px;
            border-left-color: inherit;
            right: -5px;
        }

        .digit .d4 {
            width: 5px;
            height: 14px;
            top: 7px;
            left: 0;
        }
        .digit .d4:before {
            border-width: 0 5px 5px 0;
            border-bottom-color: inherit;
            top: -5px;
        }
        .digit .d4:after {
            border-width: 0 0 5px 5px;
            border-left-color: inherit;
            bottom: -5px;
        }

        .digit .d5 {
            width: 5px;
            height: 14px;
            top: 7px;
            right: 0;
        }
        .digit .d5:before {
            border-width: 0 0 5px 5px;
            border-bottom-color: inherit;
            top: -5px;
        }
        .digit .d5:after {
            border-width: 5px 0 0 5px;
            border-top-color: inherit;
            bottom: -5px;
        }

        .digit .d6 {
            width: 5px;
            height: 14px;
            top: 32px;
            left: 0;
        }
        .digit .d6:before {
            border-width: 0 5px 5px 0;
            border-bottom-color: inherit;
            top: -5px;
        }
        .digit .d6:after {
            border-width: 0 0 5px 5px;
            border-left-color: inherit;
            bottom: -5px;
        }

        .digit .d7 {
            width: 5px;
            height: 14px;
            top: 32px;
            right: 0;
        }
        .digit .d7:before {
            border-width: 0 0 5px 5px;
            border-bottom-color: inherit;
            top: -5px;
        }
        .digit .d7:after {
            border-width: 5px 0 0 5px;
            border-top-color: inherit;
            bottom: -5px;
        }

        .digit span.on {
            opacity: 1;
        }

        button {
            margin: 10px;
            padding: 10px 20px;
            font-size: 16px;
            color: white;
            background-color: #272e38;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background-color: #444;
        }

        .button-group { /* Style the button container */
            display: flex; /* Arrange buttons horizontally */
            gap: 10px;      /* Add some space between buttons */
        }

       #hidden-number, #question-output {
            margin-top: 10px;
            color: white;
            font-size: 18px;
        }
        .question-input {
            margin-top: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
            background-color: #fcf6d6;  
            padding: 2px 5px 2px 5px; 
            border-radius: 10px;
            width: 500px;
            justify-content: center;
        }
        .question-input select, .question-input button {
            padding: 5px;
            font-size: 16px;
        }

        #history-panel {
          margin: 10px 0; max-height: 5em; overflow-y: auto; border: 1px solid #ccc; padding: 10px; background-color: #f9f9f9; width: 500px; font-size: 13px;
        }

        #match-result {
    font-size: 18px;
    font-weight: bold;
    margin-left: 10px;
    color: white;
}
    </style>
</head>
<body>
    <section class="top">
      <div>DIGIT CODE</div>
      <div><a href="https://smartstore.naver.com/playte">디지트 코드 구매 - Playte Store</a></div>
    </section>
    <div class="button-group">  <button onclick="revealDigits()">숫자 공개</button>
        <button onclick="hideDigits()">숫자 숨기기</button>
            <button onclick="generateRandomDigitsWithRules()">숫자 생성</button>
    </div>
    <div class="board" id="digit-board">
        <div class="digit" id="digit-1"><span class="d1"></span><span class="d2"></span><span class="d3"></span><span class="d4"></span><span class="d5"></span><span class="d6"></span><span class="d7"></span></div>
        <div class="digit" id="digit-2"><span class="d1"></span><span class="d2"></span><span class="d3"></span><span class="d4"></span><span class="d5"></span><span class="d6"></span><span class="d7"></span></div>
        <div class="digit" id="digit-3"><span class="d1"></span><span class="d2"></span><span class="d3"></span><span class="d4"></span><span class="d5"></span><span class="d6"></span><span class="d7"></span></div>
        <div class="digit" id="digit-4"><span class="d1"></span><span class="d2"></span><span class="d3"></span><span class="d4"></span><span class="d5"></span><span class="d6"></span><span class="d7"></span></div>
        <div class="digit" id="digit-5"><span class="d1"></span><span class="d2"></span><span class="d3"></span><span class="d4"></span><span class="d5"></span><span class="d6"></span><span class="d7"></span></div>
        <div class="digit" id="digit-6"><span class="d1"></span><span class="d2"></span><span class="d3"></span><span class="d4"></span><span class="d5"></span><span class="d6"></span><span class="d7"></span></div>
    </div>

<div class="answer-input">
    <label for="user-input">정답 입력:</label>
    <input type="text" id="user-input" maxlength="6" pattern="\d{6}" placeholder="6자리 숫자">
    <button onclick="checkUserInput()">맞춰보기</button>
    <span id="match-result"></span>
</div>

    <div class="question-input">
        <select id="row-col-value">
            <option value="A">A</option><option value="B">B</option><option value="C">C</option>
            <option value="D">D</option><option value="E">E</option><option value="F">F</option>
            <option value="G">G</option><option value="H">H</option><option value="I">I</option>
            <option value="J">J</option><option value="K">K</option><option value="L">L</option>
            <option value="M">M</option><option value="N">N</option><option value="O">O</option>
            <option value="P">P</option><option value="Q">Q</option><option value="R">R</option>
            <option value="S">S</option>
        </select>
        <label for="row-col-value">에는 몇 칸이 채워져 있나요?</label>
        <button onclick="handleHowManyQuestion()">물어보기</button>
    </div>

<div class="question-input">
    <select id="digit-value">
        <option value="T">(T)</option>
        <option value="U">(U)</option>
        <option value="V">(V)</option>
        <option value="W">(W)</option>
        <option value="X">(X)</option>
        <option value="Y">(Y)</option>
    </select>
    <label for="digit-value">는 짝수 인가요 홀수 인가요?</label>

    <button onclick="handleDigitEvenOddQuestion()">물어보기</button>
</div>

<div class="question-input">
    <label for="digit-pair">다음 숫자중 어떤게 더 큰가요?</label>
    <select id="digit-pair">
        <option value="T-U">(T-U)</option>
        <option value="U-V">(U-V)</option>
        <option value="W-X">(W-X)</option>
        <option value="X-Y">(X-Y)</option>
        <option value="T-W">(T-W)</option>
        <option value="U-X">(U-X)</option>
        <option value="V-Y">(V-Y)</option>
    </select>
    <button onclick="handleComparisonQuestion()">물어보기</button>
</div>

<div class="question-input">
    <label for="column-value">열 </label>
    <select id="column-value">
        <option value="A">A</option><option value="B">B</option><option value="C">C</option>
        <option value="D">D</option><option value="E">E</option><option value="F">F</option>
        <option value="G">G</option><option value="H">H</option><option value="I">I</option>
    </select>
    
    <label for="row-value">, 행 </label>
    <select id="row-value">
        <option value="J">J</option><option value="K">K</option><option value="L">L</option>
        <option value="M">M</option><option value="N">N</option><option value="O">O</option>
        <option value="P">P</option><option value="Q">Q</option><option value="R">R</option>
        <option value="S">S</option>
    </select>
    <label for="row-value"> 칸은 채워져 있나요? </label>
    <button onclick="handleSegmentFilledQuestion()">물어보기</button>
</div>



<div id="history-panel" style="">
</div>

     <div id="question-output"></div>

    <div class="question-output" id="question-output"></div>

    <script>
        let hiddenDigits = [];
        let numberGenerated = false;

        const digitSegments = {
            0: ['d1', 'd3', 'd4', 'd5', 'd6', 'd7'],
            1: ['d5', 'd7'],
            2: ['d1', 'd2', 'd3', 'd5', 'd6'],
            3: ['d1', 'd2', 'd3', 'd5', 'd7'],
            4: ['d2', 'd4', 'd5', 'd7'],
            5: ['d1', 'd2', 'd3', 'd4', 'd7'],
            6: ['d1', 'd2', 'd3', 'd4', 'd6', 'd7'],
            7: ['d1', 'd5', 'd7'],
            8: ['d1', 'd2', 'd3', 'd4', 'd5', 'd6', 'd7'],
            9: ['d1', 'd2', 'd3', 'd4', 'd5', 'd7']
        };

        function clearSegments(digitId) {
            document.querySelectorAll(`#${digitId} span`).forEach(span => span.classList.remove('on'));
        }

        function lightUpDigit(digitId, number) {
            clearSegments(digitId);
            digitSegments[number].forEach(segment => {
                document.querySelector(`#${digitId} .${segment}`).classList.add('on');
            });
        }

        function generateRandomDigitsWithRules() {
            hiddenDigits = [];
            numberGenerated = true;
            const usedNumbers = Array(10).fill(0);

            for (let i = 0; i < 6; i++) {
                let randomDigit;
                do {
                    randomDigit = Math.floor(Math.random() * 10);
                } while (
                    usedNumbers[randomDigit] === 2 ||
                    (i > 0 && hiddenDigits[i - 1] === randomDigit) ||
                    (i >= 3 && hiddenDigits[i - 3] === randomDigit)
                );

                hiddenDigits.push(randomDigit);
                usedNumbers[randomDigit]++;
            }

            console.log("Hidden Digits Generated:", hiddenDigits);
            document.getElementById('hidden-number').innerText = "Hidden Number: " + hiddenDigits.join('');

            document.querySelectorAll('.digit span').forEach(span => span.classList.remove('on'));
        }

        function revealDigits() {
            if (!numberGenerated) return;

            hiddenDigits.forEach((num, index) => {
                lightUpDigit(`digit-${index + 1}`, num);
            });
        }

function hideDigits() {
    if (!numberGenerated) return;

    hiddenDigits.forEach((num, index) => {
        const digitId = `digit-${index + 1}`;
        clearSegments(digitId);
    });
}

function calculateFilledSpaces(letter) {
    let count = 0;

    const columnMapping = {
        'A': ['d4', 'd6'],
        'B': ['d1', 'd2', 'd3'],
        'C': ['d5', 'd7'],
        'D': ['d4', 'd6'],
        'E': ['d1', 'd2', 'd3'],
        'F': ['d5', 'd7'],
        'G': ['d4', 'd6'],
        'H': ['d1', 'd2', 'd3'],
        'I': ['d5', 'd7']
    };

    const rowMapping = {
        'J': ['d1'],
        'K': ['d4', 'd5'],
        'L': ['d2'],
        'M': ['d6', 'd7'],
        'N': ['d3'],
        'O': ['d1'],
        'P': ['d4', 'd5'],
        'Q': ['d2'],
        'R': ['d6', 'd7'],
        'S': ['d3']
    };

    hiddenDigits.forEach((digit, index) => {
        let segments = digitSegments[digit];

        if (columnMapping[letter] && index % 3 === Math.floor((letter.charCodeAt(0) - 65) / 3)) {
            columnMapping[letter].forEach(segment => {
                if (segments.includes(segment)) count++;
            });
        }

        if (rowMapping[letter]) {
            const isUpperRow = index < 3;
            const isLowerRow = index >= 3;
            if ((isUpperRow && 'JKLMN'.includes(letter)) || (isLowerRow && 'OPQRS'.includes(letter))) {
                rowMapping[letter].forEach(segment => {
                    if (segments.includes(segment)) count++;
                });
            }
        }
    });

    return count;
}

function isDigitEvenOrOdd(letter) {
    const letterMapping = { 'T': 0, 'U': 1, 'V': 2, 'W': 3, 'X': 4, 'Y': 5 };
    const index = letterMapping[letter];

    if (index !== undefined && hiddenDigits[index] !== undefined) {
        return hiddenDigits[index] % 2 === 0 ? "짝수" : "홀수";
    }
    return "잘못된 입력입니다";
}


function handleDigitEvenOddQuestion() {
    const digitLetter = document.getElementById('digit-value').value;
    const digitIndex = digitLetter.charCodeAt(0) - 'T'.charCodeAt(0);

    if (digitIndex < 0 || digitIndex >= hiddenDigits.length) {
        document.getElementById('question-output').innerText = "잘못된 입력입니다.";
        return;
    }

    const digit = hiddenDigits[digitIndex];
    const parity = digit % 2 === 0 ? "짝수" : "홀수";

    document.getElementById('question-output').innerText = `(${digitLetter}) 는 ${parity} 입니다.`;

    const historyPanel = document.getElementById('history-panel');
    const answerEntry = document.createElement('div');
    answerEntry.innerText = `Q: ${digitLetter} 는 짝수 인가요 홀수 인가요? A: ${parity}`;
    historyPanel.appendChild(answerEntry);

    historyPanel.scrollTop = historyPanel.scrollHeight;
}



function handleHowManyQuestion() {
    const letter = document.getElementById('row-col-value').value;
    const filledCount = calculateFilledSpaces(letter);

    document.getElementById('question-output').innerText = `${letter} 는 ${filledCount} 칸 채워져 있습니다.`;

    const historyPanel = document.getElementById('history-panel');
    const answerEntry = document.createElement('div');
    answerEntry.innerText = `Q: ${letter}에는 몇 칸이 채워져 있나요? A: ${filledCount}`;
    historyPanel.appendChild(answerEntry);

    historyPanel.scrollTop = historyPanel.scrollHeight;
}

function updateSecondDigitOptions() {
    const firstDigit = document.getElementById('first-digit').value;
    const secondDigitDropdown = document.getElementById('second-digit');
    secondDigitDropdown.innerHTML = ''; // Clear previous options

    const adjacentPairs = {
        'T': ['U', 'W'],
        'U': ['T', 'V', 'X'],
        'V': ['U', 'W', 'Y'],
        'W': ['V', 'T', 'X'],
        'X': ['U', 'W', 'Y'],
        'Y': ['V', 'X']
    };

    adjacentPairs[firstDigit].forEach(adjacent => {
        let option = document.createElement('option');
        option.value = adjacent;
        option.textContent = `(${adjacent})`;
        secondDigitDropdown.appendChild(option);
    });
}

function handleComparisonQuestion() {
    const selectedPair = document.getElementById("digit-pair").value;
    const [firstDigit, secondDigit] = selectedPair.split("-");

    const firstIndex = firstDigit.charCodeAt(0) - "T".charCodeAt(0);
    const secondIndex = secondDigit.charCodeAt(0) - "T".charCodeAt(0);

    let resultText = "";
    if (hiddenDigits[firstIndex] > hiddenDigits[secondIndex]) {
        resultText = `${firstDigit} 가 더 큽니다.`;
    } else if (hiddenDigits[firstIndex] < hiddenDigits[secondIndex]) {
        resultText = `${secondDigit} 가 더 큽니다.`;
    } else {
        resultText = `Both digits (${firstDigit} and ${secondDigit}) are equal.`;
    }

    document.getElementById('question-output').innerText = resultText;

    const historyPanel = document.getElementById('history-panel');
    const answerEntry = document.createElement('div');
    answerEntry.innerText = `Q: ${firstDigit} 와 ${secondDigit} 중에 어떤게 더 큰가요? A: ${resultText}`;
    historyPanel.appendChild(answerEntry);

    historyPanel.scrollTop = historyPanel.scrollHeight;
}

function isSegmentFilled(column, row) {
    const segmentMatrix = {
        "A-J": null, "B-J": "first-digit-d1", "C-J": null, "D-J": null, "E-J": "second-digit-d1", "F-J": null, "G-J": null, "H-J": "third-digit-d1", "I-J": null,
        "A-K": "first-digit-d4", "B-K": null, "C-K": "first-digit-d5", "D-K": "second-digit-d4", "E-K": null, "F-K": "second-digit-d5", "G-K": "third-digit-d4", "H-K": null, "I-K": "third-digit-d5",
        "A-L": null, "B-L": "first-digit-d2", "C-L": null, "D-L": null, "E-L": "second-digit-d2", "F-L": null, "G-L": null, "H-L": "third-digit-d2", "I-L": null,
        "A-M": "first-digit-d6", "B-M": null, "C-M": "first-digit-d7", "D-M": "second-digit-d6", "E-M": null, "F-M": "second-digit-d7", "G-M": "third-digit-d6", "H-M": null, "I-M": "third-digit-d7",
        "A-N": null, "B-N": "first-digit-d3", "C-N": null, "D-N": null, "E-N": "second-digit-d3", "F-N": null, "G-N": null, "H-N": "third-digit-d3", "I-N": null,
        "A-O": null, "B-O": "fourth-digit-d1", "C-O": null, "D-O": null, "E-O": "fifth-digit-d1", "F-O": null, "G-O": null, "H-O": "sixth-digit-d1", "I-O": null,
        "A-P": "fourth-digit-d4", "B-P": null, "C-P": "fourth-digit-d5", "D-P": "fifth-digit-d4", "E-P": null, "F-P": "fifth-digit-d5", "G-P": "sixth-digit-d4", "H-P": null, "I-P": "sixth-digit-d5",
        "A-Q": null, "B-Q": "fourth-digit-d2", "C-Q": null, "D-Q": null, "E-Q": "fifth-digit-d2", "F-Q": null, "G-Q": null, "H-Q": "sixth-digit-d2", "I-Q": null,
        "A-R": "fourth-digit-d6", "B-R": null, "C-R": "fourth-digit-d7", "D-R": "fifth-digit-d6", "E-R": null, "F-R": "fifth-digit-d7", "G-R": "sixth-digit-d6", "H-R": null, "I-R": "sixth-digit-d7",
        "A-S": null, "B-S": "fourth-digit-d3", "C-S": null, "D-S": null, "E-S": "fifth-digit-d3", "F-S": null, "G-S": null, "H-S": "sixth-digit-d3", "I-S": null,
    };

    const key = `${column}-${row}`;
    const segment = segmentMatrix[key];

    if (!segment) {
        return "잘못된 조합 선택 입니다";
    }

    const digitIndex = "ABC".includes(column) ? (["J", "K", "L", "M", "N"].includes(row) ? 0 : 3) :
                       "DEF".includes(column) ? (["J", "K", "L", "M", "N"].includes(row) ? 1 : 4) :
                       "GHI".includes(column) ? (["J", "K", "L", "M", "N"].includes(row) ? 2 : 5) : -1;

    if (digitIndex === -1) {
        return "잘못된 조합 선택 입니다";
    }

    const digit = hiddenDigits[digitIndex];

    const actualSegment = segment.split('-')[2];

    return digitSegments[digit].includes(actualSegment) ? "네, 채워져 있습니다" : "아니요, 빈칸 입니다";
}


function handleSegmentFilledQuestion() {
    const column = document.getElementById('column-value').value;
    const row = document.getElementById('row-value').value;
    
    const result = isSegmentFilled(column, row);

    document.getElementById('question-output').innerText = `Q: ${column}-${row} 는 채워져 있나요? A: ${result}`;

    const historyPanel = document.getElementById('history-panel');
    const answerEntry = document.createElement('div');
    answerEntry.innerText = `Q: ${column}-${row} 는 채워져 있나요? A: ${result}`;
    historyPanel.appendChild(answerEntry);

    historyPanel.scrollTop = historyPanel.scrollHeight;
}


function checkUserInput() {
    const userInput = document.getElementById("user-input").value;
    const resultDisplay = document.getElementById("match-result");

    if (!numberGenerated) {
        resultDisplay.innerText = "숫자가 생성되지 않았습니다!";
        return;
    }

    if (userInput.length !== 6 || isNaN(userInput)) {
        resultDisplay.innerText = "6자리 숫자를 입력하세요!";
        return;
    }

    if (userInput === hiddenDigits.join('')) {
        resultDisplay.innerText = "정답!";
        resultDisplay.style.color = "yellow";
    } else {
        resultDisplay.innerText = "오답!";
        resultDisplay.style.color = "red";
    }
}

    </script>
</body>
</html>
